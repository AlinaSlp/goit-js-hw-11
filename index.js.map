{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst API_KEY = \"52982247-0d25e92a2d7c3074b601ee372\";\nconst PER_PAGE = 9;\n\nexport async function getImagesByQuery(query, page = 1) {\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: true,\n    page,\n    per_page: PER_PAGE,\n  };\n\n  const response = await axios.get(BASE_URL, { params });\n  return response.data;\n}\n\nexport const PER_PAGE_COUNT = PER_PAGE;\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst refs = {\n  gallery: document.querySelector(\".gallery\"),\n  loader: document.querySelector(\".loader\"),\n  loadMoreBtn: document.querySelector(\".load-more-btn\"),\n};\n\nconst lightbox = new SimpleLightbox(\".gallery a\", {\n  captionsData: \"alt\",\n  captionDelay: 250,\n});\n\nexport function createGallery(images, append = false) {\n  const markup = images\n    .map(\n      img => `\n      <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${img.largeImageURL}\">\n          <img class=\"gallery-image\" src=\"${img.webformatURL}\" alt=\"${img.tags}\" loading=\"lazy\"/>\n        </a>\n        <div class=\"info\">\n          <p class=\"info-item\"><b>Likes:</b><p class=\"info-item-result\">${img.likes}</p></p>\n          <p class=\"info-item\"><b>Views:</b><p class=\"info-item-result\">${img.views}</p></p>\n          <p class=\"info-item\"><b>Comments:</b><p class=\"info-item-result\">${img.comments}</p></p>\n          <p class=\"info-item\"><b>Downloads:</b><p class=\"info-item-result\">${img.downloads}</p></p>\n        </div>\n      </li>`\n    )\n    .join(\"\");\n\n  if (append) {\n    refs.gallery.insertAdjacentHTML(\"beforeend\", markup);\n  } else {\n    refs.gallery.innerHTML = markup;\n  }\n  \n  lightbox.refresh();\n}\n\nexport function clearGallery() {\n  refs.gallery.innerHTML = \"\";\n}\n\nexport function showLoader() {\n  refs.loader.classList.remove(\"hidden\");\n}\nexport function hideLoader() {\n  refs.loader.classList.add(\"hidden\");\n}\n\nexport function showLoadMore() {\n  refs.loadMoreBtn.classList.remove(\"is-hidden\");\n}\nexport function hideLoadMore() {\n  refs.loadMoreBtn.classList.add(\"is-hidden\");\n}\n","import { getImagesByQuery, PER_PAGE_COUNT } from \"./js/pixabay-api.js\";\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMore,\n  hideLoadMore,\n} from \"./js/render-functions.js\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst refs = {\n  form: document.querySelector(\".form\"),\n  input: document.querySelector('input[name=\"search-text\"]'),\n  loadMoreBtn: document.querySelector(\".load-more-btn\"),\n};\n\nlet query = \"\";\nlet page = 1;\nlet totalHits = 0;\n\nrefs.form.addEventListener(\"submit\", onSearch);\nrefs.loadMoreBtn.addEventListener(\"click\", onLoadMore);\n\nasync function onSearch(e) {\n  e.preventDefault();\n  const value = refs.input.value.trim();\n\n  if (value === \"\") {\n    iziToast.warning({\n      title: \"Warning\",\n      message: \"Please enter a search query\",\n      position: \"topRight\",\n    });\n    return;\n  }\n\n  clearGallery();\n  hideLoadMore();\n\n  showLoader();\n\n  query = value;\n  page = 1;\n\n  try {\n    const data = await getImagesByQuery(query, page);\n    hideLoader();\n\n    if (!data.hits || data.hits.length === 0) {\n      iziToast.error({\n        title: \"\",\n        message: \"Sorry, there are no images matching your search query. Please try again!\",\n        position: \"topRight\",\n      });\n      return;\n    }\n\n    totalHits = data.totalHits;\n    createGallery(data.hits);\n\n    refs.input.value = \"\";\n\n    const totalPages = Math.ceil(totalHits / PER_PAGE_COUNT);\n    if (page < totalPages) {\n      showLoadMore();\n    } \n    \n  } catch (err) {\n    hideLoader();\n    console.error(err);\n    iziToast.error({\n      title: \"Error\",\n      message: \"Something went wrong while fetching images.\",\n      position: \"topRight\",\n    });\n  }\n}\n\nasync function onLoadMore() {\n  page += 1;\n  showLoader();\n  try {\n    const data = await getImagesByQuery(query, page);\n    hideLoader();\n    createGallery(data.hits, true);\n\n    const totalPages = Math.ceil(totalHits / PER_PAGE_COUNT);\n    if (page >= totalPages) {\n      hideLoadMore();\n      iziToast.info({\n        title: \"End of results\",\n        message: \"You have reached the end of the search results.\",\n        position: \"topRight\",\n      });\n    }\n    const { height: cardHeight } = document\n      .querySelector(\".gallery\")\n      .firstElementChild.getBoundingClientRect();\n\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: \"smooth\",\n    });\n  } catch (error) {\n    hideLoader();\n    console.error(error);\n  }\n}"],"names":["BASE_URL","API_KEY","PER_PAGE","getImagesByQuery","query","page","params","axios","PER_PAGE_COUNT","refs","lightbox","SimpleLightbox","createGallery","images","append","markup","img","clearGallery","showLoader","hideLoader","showLoadMore","hideLoadMore","totalHits","onSearch","onLoadMore","e","value","iziToast","data","totalPages","err","cardHeight","error"],"mappings":"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"}